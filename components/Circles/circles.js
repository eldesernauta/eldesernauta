// src/components/TransformBubbles.js
import React, { useEffect, useRef } from "react";
import { gsap, ScrollTrigger } from "gsap";

gsap.registerPlugin(ScrollTrigger);

const Circles = () => {
    // Refs individuales para cada círculo
    const circleRefs = [useRef(null), useRef(null), useRef(null), useRef(null)];

    useEffect(() => {
        circleRefs.forEach((ref, index) => {
            const element = ref.current;

            // Determinar color y configuración de animación
            const color = element.getAttribute("data-color");
            const rotateDirection = color === "#b37dff" ? 360 : -360; // Derecha o izquierda
            const duration = 5 + index * 2; // Velocidades diferentes según el índice

            // GSAP Animation
            gsap.to(element, {
                scrollTrigger: {
                    trigger: element,
                    start: "-200px center",
                    end: "bottom top",
                    scrub: true,
                },
                rotate: rotateDirection,
                duration,
            });
        });
    }, []);

    return (
        <div className="relative h-screen flex items-center justify-center">
            <div className="transform-bubbles relative">
                <Circle ref={circleRefs[0]} color="#b37dff" />
                <Circle ref={circleRefs[1]} className="absolute top-0 scale-[75%]" color="#ff5454" />
                <Circle ref={circleRefs[2]} className="absolute top-0 scale-[55%]" color="#b37dff" />
                <Circle ref={circleRefs[3]} className="absolute top-0 scale-[40%]" color="#ff5454" />
            </div>
        </div>
    );
};

export default Circles;

let Circle = ({ className, color }, ref) => {
    return (
        <svg
            xmlns="http://www.w3.org/2000/svg"
            xmlSpace="preserve"
            ref={ref}
            data-color={color} // Agregar color como atributo de datos
            className={`${className} w-[500px] h-[500px] mx-auto`}
            viewBox="0 0 1093.7 1094.3"
        >
            <path d="m918.1 902.1 16.7-20.9-60.9-48.9 24.8-30.9 60.9 48.9 16.7-20.9 25.6 20.5-58.2 72.7-25.6-20.5zm-28.3 67.5c-8.2-10.6-19.3-25-27.5-35.6-13.2 10.2-3.5 2.7-16.6 12.9 8.2 10.6 19.3 25 27.5 35.6l-31.4 24.2L774 919l31.3-24.3c8.2 10.6 19.3 24.9 27.4 35.6 13.2-10.2 3.4-2.7 16.6-12.9-8.2-10.6-19.3-24.9-27.4-35.6l31.4-24.2 67.8 87.8-31.3 24.2zm-164.3 92.7-13.2-30.1 45.3-19.9-4.9-11.1c-7.3 3.2-29.1 12.8-36.4 16l-8.5-19.3c7.3-3.2 29.1-12.8 36.4-16l-4.9-11.1-45.3 20-13.2-30.1 81.6-35.9 44.6 101.7-81.5 35.8zm-184 28.7-7.1-31.4-17.8-78.5 38.8-1.9 5.6 24.5 19.2-.9 3.1-24.9L622 976l-10.1 79.9-4 32-66.4 3.1zm30.1-40.4c.1.6.7 1 1.3 1 .6 0 1.1-.5 1.2-1.1l3.3-26.5-11.7.6 5.9 26zm-243 .2 13.8-30.3 19.2-41.9 13.9-30.3 53.7 14-1.5 33.5-.5 13.1c0 .7.4 1.3 1.1 1.5.7.2 1.3-.1 1.6-.7l5.9-11.7 15.1-30 53.7 14-2.7 33.2-3.7 45.9-2.7 33.2-37.6-9.8 2.5-33.3 2.7-36.7c0-.7-.4-1.3-1.1-1.5-.7-.2-1.3.1-1.7.8l-15.5 33.4-14 30.3-37.6-9.8 2.5-33.3 2.7-36.7c0-.7-.4-1.3-1.1-1.5-.7-.2-1.3.1-1.7.8l-15.5 33.4-14 30.3-37.5-9.9zm-108.7-69 17.5-27.8 41.9 26.4 6.4-10.3c-6.7-4.2-27-17-33.7-21.2l11.2-17.9c6.7 4.2 27 17 33.7 21.2l6.5-10.3-41.9-26.3 17.5-27.8 75.4 47.5-59 94-75.5-47.5zm-33-92.8c-14.3-20-39.8-42.1-17.4-63.2 18.3-17.2 39.2-9.1 53.5 6.1l49 52.1-23.8 22.5-38.8-41.3c-7.5-8.1-14.9.9-9.4 8.6 14.3 20 39.1 41.4 16.7 62.5-18.3 17.2-38.5 9.8-52.8-5.4l-49.7-52.8 23.8-22.5 39.5 42c7.5 8.1 14.9-.9 9.4-8.6zm-97-167.9c66.9-35.1 120.6 67.2 53.6 102.4S22.9 756.3 89.9 721.1zm19.1 36.5c-26.6 14-11.2 43.5 15.5 29.5 26.5-14 11-43.5-15.5-29.5zm15.8-120.4-58.3 21.3c-.7.3-1.1 1-.9 1.7.2.7.9 1.2 1.6 1l59.9-10.2 6.7 39.1-109.2 18.6-10.4-61 43.2-17.3c.6-.2 1-.9.9-1.6-.1-.7-.7-1.2-1.3-1.2l-46.5-1.9-10.5-61L109.3 546l6.7 39.1-60 10.2c-.7.1-1.3.8-1.2 1.5 0 .8.7 1.3 1.4 1.3l62.1.7 6.5 38.4zM14.4 431.8l32.5 4.1-6.2 49.2 12 1.5 5-39.5 20.9 2.6-5 39.5 12.1 1.5 6.1-49.2 32.6 4.1-11.2 88.5-110-13.9 11.2-88.4zm131.3-45.9-60.7-13c-.7-.1-1.4.3-1.6 1-.3.7.1 1.4.8 1.7l56.3 23.1-15 36.7-102.7-42.1L47.1 334l60.7 12.9c.7.1 1.4-.3 1.6-1 .2-.7-.1-1.5-.8-1.8L52.3 321l15-36.7L170 326.5l-24.3 59.4zm-2.2-207.3 26.1 19.9-30 39.4 9.7 7.4c4.8-6.3 19.3-25.3 24.1-31.7l16.8 12.8c-4.8 6.3-19.3 25.3-24.1 31.7l9.7 7.4 29.9-39.5 26.1 19.9-54 71-88.2-67.3 53.9-71zm95.3-24.6c21.2-12.4 45.4-35.9 64.5-11.7 15.5 19.8 5.5 39.9-10.8 52.8l-56.2 44.3-20.3-25.8 44.5-35.1c8.7-6.8.4-15-7.7-10.2-21.2 12.5-44.7 35.3-63.7 11.1-15.5-19.8-6.3-39.3 10-52.2l57-44.9 20.2 25.8-45.3 35.7c-8.6 6.8-.3 15 7.8 10.2zm117.5-69.3c23.8-6.3 53.4-22.3 65.2 6.2 9.6 23.2-5.4 39.9-24.7 47.9l-66 27.4-12.5-30.3 52.3-21.7c10.2-4.2 4.5-14.3-4.6-11.9-23.8 6.3-52.5 21.9-64.3-6.6-9.6-23.2 4.5-39.5 23.8-47.5l67-27.8L405 50.7l-53.2 22.1c-10.3 4.2-4.6 14.3 4.5 11.9zM611 57.3c-.7 75.7-116.1 74.6-115.4-1.1.7-75.7 116.1-74.6 115.4 1.1zm-41.1-.3c.3-30.1-33-30.4-33.3-.3-.3 30 33 30.3 33.3.3zm162.6-26.5-8.4 31.8-47.9-12.7-3.1 11.7 38.4 10.1-5.4 20.4-38.4-10.1-11.4 43.5-38.2-10.2L646.4 7.7l86.1 22.8zM891 120.7l-13.8 29.1-34.5 72.7-31.6-22.5 10.7-22.7-15.6-11.1-17.8 17.6-31.6-22.5 57.2-56.5 22.9-22.6 54.1 38.5zm-48.5 13.2c.3-.6.1-1.2-.4-1.6-.5-.4-1.2-.3-1.6.1l-19 18.8 9.6 6.8 11.4-24.1zm122.8 121.2c-32.1 27.6-62.1-.6-60.2-21.8 0-.6-.3-1.1-.8-1.4-.5-.2-1.1-.2-1.6.2l-29.8 25.7-25.8-30.1 84.1-72.3 38.3 44.7c14 16.3 12.1 41.1-4.2 55zm-25.8-39.7-7.3-8.5-10.4 8.9 7.3 8.5c5.7 6.6 17.4-.8 10.4-8.9zm82.8 147.8c-37.7 19.1-60.1-15.5-53.3-35.6.2-.5 0-1.1-.4-1.5-.5-.4-1-.5-1.6-.2l-35 17.7-17.8-35.4 98.9-50.1 26.5 52.5c9.7 19.3 1.9 42.9-17.3 52.6zm-15.6-44.8-5.1-10.1-12.2 6.2 5 10.1c4.1 7.7 17.2 3.4 12.3-6.2zm-47.3 85 107.5-27.2 9.8 38.4c-55.8 14.1-49.1 12.4-75.8 19.2l10.3 40.3-31.9 8.1-19.9-78.8zM1093.7 574l-32.8 1-1.5-49.5-12.1.4c.2 7.9 1 31.8 1.3 39.8l-21 .7c-.3-7.9-1-31.8-1.3-39.8l-12.2.4 1.6 49.5-32.8 1-2.8-89.2 110.8-3.5 2.8 89.2zm-58.4 79.2c-8.6 23.1-12.7 56.5-42.7 49.8-24.5-5.5-29.4-27.5-24.8-47.8l15.7-69.8 31.9 7.2-12.5 55.3c-2.5 10.7 9.1 11.9 12.4 3.1 8.6-23.1 12.5-55.6 42.4-48.8 24.5 5.5 29.6 26.5 25.1 46.8l-16 70.8-31.9-7.2 12.7-56.3c2.5-10.8-9.1-11.9-12.3-3.1zM948.8 745c-7.8-3.3-10.5-14.5-6-24.9 4.4-10.4 14.4-16.1 22.1-12.8 7.8 3.3 10.5 14.5 6 24.9-4.4 10.5-14.4 16.2-22.1 12.8z" fill={`${color}`} />
        </svg>
    )
}


// Usar forwardRef para pasar la ref al SVG
Circle = React.forwardRef(Circle);